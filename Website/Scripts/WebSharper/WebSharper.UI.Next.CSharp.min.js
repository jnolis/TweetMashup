(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;a=window;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Next=c.Next||{};e=d.CSharp=d.CSharp||{};f=e.ViewExtensions=e.ViewExtensions||{};g=e.DocExtension=e.DocExtension||{};h=e.Client=e.Client||{};i=h.Helpers=h.Helpers||{};j=h.RouteMapBuilder=h.RouteMapBuilder||{};k=h.RouteItemParsers=h.RouteItemParsers||{};l=d&&d.View;m=d&&d.Doc;n=d&&d.Var;o=b&&b.List;p=a.IntelliFactory;q=p&&p.Runtime;r=d&&d.RouteMap;s=b&&b.Seq;t=b&&b.Unchecked;u=b&&b.Arrays;v=b&&b.Collections;w=v&&v.Map;x=b&&b.Nullable;y=b&&b.Operators;z=v&&v.FSharpMap;A=b&&b.Option;f.UpdateWhile=function(B,C,D){return l.UpdateWhile(C,D,B);};g.DocSeqCached=function(B,C,D){return m.ConvertSeqBy(C,function(E){return function(F){return D(E,F);};},B);};i.seqRefToListRef=function(B){return n.Lens(B,o.ofSeq,function(C,D){return D;});};j=h.RouteMapBuilder=q.Class({Install:function(){var B,C;function D(E,F){return E(function(G){return n.Set(B,G);},F);}B=r.Install(this.ToRouteMap());C=o.map(function(E){return function(F){return D(E,F);};},o.rev(this.renders));return m.BindView(function(E){return s.pick(function(F){return F(E);},C);},B.v);},ToRouteMap:function(){var B,C;B=o.rev(this.links);C=o.rev(this.routes);return r.CreateWithQuery(function(D){return s.pick(function(E){return E(D);},B);},function(D){return s.pick(function(E){return E(D);},C);});},AddRender:function(B){this.renders=new o.T({$:1,$0:B,$1:this.renders});},AddLink:function(B){this.links=new o.T({$:1,$0:B,$1:this.links});},AddRoute:function(B){this.routes=new o.T({$:1,$0:B,$1:this.routes});}},b.Obj,j);j.New=q.Ctor(function(){this.links=o.T.Empty;this.routes=o.T.Empty;this.renders=o.T.Empty;},j);k["System.Double"]=function(B){var C,D;C=B[0];return C.$==1?(D=(new a.RegExp("^[0-9](?:\\.[0-9]*)?$")).exec(C.$0),t.Equals(D,null)?null:{$:1,$0:[a.parseFloat(u.get(D,0)),C.$1]}):null;};k["System.Int32"]=function(B){var C,D;C=B[0];return C.$==1?(D=(new a.RegExp("^[0-9]+$")).exec(C.$0),t.Equals(D,null)?null:{$:1,$0:[a.parseInt(u.get(D,0),a.$1),C.$1]}):null;};k["System.String"]=function(B){var C;C=B[0];return C.$==1?{$:1,$0:[C.$0,C.$1]}:null;};k.MakeLink=function(B){return function(C){var D,E;function F(I,J,K,L){var M,N,O,P,Q,R;return J===0?(M=L(C[I]),(D[0]=w.FoldBack(function(S,T,U){return U.Add(S,T);},M[1],D[0]),M[0])):J===1?(D[0]=(N=o.head((L(C[I]))[0]),D[0].Add(I,N)),o.T.Empty):J===2?(O=C[I],O!=null&&O.$==1?D[0]=(P=o.head((L(O.$0))[0]),D[0].Add(I,P)):void 0,o.T.Empty):J===3?(Q=C[I],(Q!=null?D[0]=(R=o.head((L(x.get(Q)))[0]),D[0].Add(I,R)):void 0,o.T.Empty)):y.FailWith("invalid QueryItem enum value");}function G(I){return I[0];}function H(I,J){return function(K){return(J(K))[0];};}return B.$==1?(D=[new z.New([])],[o.append(A.toList(B.$1),o.ofSeq(s.collect(function(I){return F(I[0],I[1],I[2],I[3]);},B.$2))),D[0]]):B.$==2?[new o.T({$:1,$0:a.String(s.length(C)),$1:o.ofSeq(s.collect((E=B.$2,function(I){return G(E(I));}),C))}),new z.New([])]:B.$==3?[o.ofSeq(s.concat((((q.Curried3(s.map2))(function(I,J){return(function(K){return H(K[0],K[1]);}(I))(J);}))(B.$0))(C))),new z.New([])]:[o.ofArray([a.String(C)]),new z.New([])];};};k.ParseRoute=function(B){var C,D;function E(F,G){return G.$==0?{$:1,$0:F}:null;}C=k.ParseShape(B);D=function(F){return F==null?null:E.apply(null,F.$0);};return function(F){return D(C(F));};};k.ParseShape=function(B){return function(C){var D,E,F,G,H,I,J,K,L,M,N;function O(Q,R,S){var T,U;function V(W,X){var Y,Z,_0,_1,_2,_3,_4,_5,_6,_7;Y=X[0];Z=X[1];_0=X[2];return W!=null&&W.$==1?(_1=W.$0,Z===0?(_2=_0([_1,E]),_2!=null&&_2.$==1?(T[Y]=_2.$0[0],{$:1,$0:_2.$0[1]}):null):Z===1?(_3=w.TryFind(Y,E),_3==null?null:(T[Y]=_3.$0,{$:1,$0:_1})):Z===2?(_4=w.TryFind(Y,E),_4!=null&&_4.$==1?(_5=_0([o.ofArray([_4.$0]),new z.New([])]),_5!=null&&_5.$==1?(T[Y]={$:1,$0:_5.$0[0]},{$:1,$0:_1}):null):(T[Y]=null,{$:1,$0:_1})):Z===3?(_6=w.TryFind(Y,E),_6!=null&&_6.$==1?(_7=_0([o.ofArray([_6.$0]),new z.New([])]),_7!=null&&_7.$==1?(T[Y]=_7.$0[0],{$:1,$0:_1}):null):(T[Y]=null,{$:1,$0:_1})):y.FailWith("invalid QueryItem enum value")):null;}T=Q();U=(((q.Curried3(u.fold))(V))({$:1,$0:R}))(S);return U==null?null:{$:1,$0:[T,U.$0]};}function P(Q,R){var S,T,U;return Q==null?null:(S=R[0]([Q.$0,E]),S==null?null:{$:1,$0:(T=S.$0[0],(U=S.$0[1],(M.push(T),U)))});}D=C[0];E=C[1];return B.$==1?B.$1==null?O(B.$0,D,B.$2):D.$==1&&(D.$0===B.$1.$0&&(F=[D.$1,D.$0],true))?O(B.$0,F[0],B.$2):null:B.$==2?(G=B.$0,(H=B.$1,(I=k["System.Int32"]([D,E]),I==null?null:(J=I.$0[0],(K=I.$0[1],(L=u.create(J,null),function(Q,R){var S;while(true)if(Q===J)return{$:1,$0:[G(L),R]};else{S=H([R,E]);if(S!=null&&S.$==1){u.set(L,Q,S.$0[0]);Q=Q+1;R=S.$0[1];}else return null;}}(0,K))))))):B.$==3?(M=[],(N=(((q.Curried3(u.fold))(P))({$:1,$0:D}))(B.$0),N==null?null:{$:1,$0:[M,N.$0]})):B.$0([D,E]);};};}());
