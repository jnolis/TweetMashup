(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;$.Define($$,{WebSharper:{Piglets:{Choose:{Stream:$.Class({Choice:function(X,Y){var Z,_0,_6=this;Z=f.New12();_0=[false];this.subscriptions[0]=$.New(h,{$:1,$0:this.pStream.Subscribe(function(_1){var _2,_3,_4,_5;if(_1.$==0){_3=_1.$0[1];_4=_1.$0[0];_5=Z.ContainsKey(_4)?Z.get_Item(_4):_3.view.call(null,Y);_6.out.Trigger(_3.stream.get_Latest());_0[0]?X.Remove(0):null;_0[0]=true;_2=X.Add(_5);}else{_2=null;}return _2;}),$1:_6.subscriptions[0]});return X.get_Container();},Chooser:function(_7){return this.chooser.view.call(null,_7);},Dispose:function(){var _8,_9,_,ba,bb,bf;_8=this.subscriptions[0];_9=i.Get(_8);try{while(_9.MoveNext()){ba=_9.get_Current();ba.Dispose();}}finally{_9.Dispose!=undefined?_9.Dispose():null;}bb=function(bc){var bd,be;bd=j.KeyValue(bc);be=bd[1][1];return be.Dispose();};bf=this.choiceSubscriptions;return k.iter(bb,bf);},Subscribe:function(bf){return this.out.Subscribe(bf);},get_ChooserStream:function(){return this.chooser.stream;},get_Latest:function(){return this.out.get_Latest();}},{New:function(bg,bh,bi){var bj;bj=$.New(this,d.New(bi.get_Id()));bj.chooser=bg;bj.out=bi;bj.pStream=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});bj.choiceSubscriptions=f.New12();bj.subscriptions=[g.ofArray([bj.chooser.stream.Subscribe(function(bk){var bl,br,bs;bl=function(bm){var bn,bo,bp;if(bj.choiceSubscriptions.ContainsKey(bm)){bn=(bj.choiceSubscriptions.get_Item(bm))[0];}else{bo=bh(bm);bp=bj.out;bj.choiceSubscriptions.set_Item(bm,[bo,bo.stream.Subscribe(function(bq){return bp.Trigger(bq);})]);bn=bo;}return[bm,bn];};br=bj.pStream;bs=m.Map(bl,bk);return br.Trigger(bs);})])];return bj;}})},ConcreteReader:$.Class({Subscribe:function(bt){return this.subscribe.call(null,bt);},get_Latest:function(){return this.latest.call(null,null);}},{New:function(bu,bv){var bw;bw=$.New(this,d.New((o.next())(null)));bw.latest=bu;bw.subscribe=bv;return bw;}}),ConcreteWriter:$.Class({Trigger:function(bx){return this.trigger.call(null,bx);}},{New:function(by){var bz;bz=$.New(this,{});bz.trigger=by;return bz;},New1:function(bA){return p.New(function(bB){var bC,bD;if(bB.$==1){bC=null;}else{bD=bB.$0;bC=bA(bD);}return bC;});}}),ConstReader:$.Class({Subscribe:function(){return r.New(function(){});},get_Latest:function(){return this.x;}},{New:function(bG){var bH;bH=$.New(this,d.New((o.next())(null)));bH.x=bG;return bH;}}),Controls:{Attr:function(bI,bJ,bK,bL){var bM;bM=function(bN){var bO,bT;bO=function(bP){var bQ,bR,bS;if(bP.$==0){bR=bP.$0;bS=bK(bR);bQ=bN["HtmlProvider@33"].SetAttribute(bN.get_Body(),bJ,bS);}else{bQ=null;}return bQ;};bO(bI.get_Latest());bT=bI.Subscribe(bO);return;};u.OnAfterRender(bM,bL);return bL;},AttrResult:function(bU,bV,bW,bX){var bY;bY=function(bZ){var b0,b3;b0=function(b1){var b2;b2=bW(b1);return bZ["HtmlProvider@33"].SetAttribute(bZ.get_Body(),bV,b2);};b0(bU.get_Latest());b3=bU.Subscribe(b0);return;};u.OnAfterRender(bY,bX);return bX;},Button:function(b4){var b5,b6,b7;b5=$.New(h,{$:0});b6=v.Tags().NewTag("button",b5);b7=function(){return function(){return b4.Trigger($.New(m,{$:0,$0:null}));};};w.Events().OnClick(b7,b6);return b6;},ButtonValidate:function(b_){var b$,ca;b$=x.Button(b_);ca=b_.get_Input();return x.EnableOnSuccess(ca,b$);},CheckBox:function(cb){var cc,cd,ce,cf,cg,ch,ci,cj,cn;cc=(x.nextId())(null);cd=v.Tags();ce=g.ofArray([y.Attr().NewAttr("type","checkbox"),y.Attr().NewAttr("id",cc)]);cf=cd.NewTag("input",ce);cg=cb.get_Latest();if(cg.$==0){ci=cg.$0;ch=void(cf.get_Body().checked=ci);}else{ch=null;}cj=cb.Subscribe(function(ck){var cl,cm;if(ck.$==1){cl=null;}else{cm=ck.$0;cl=!z.Equals(cf.get_Body().checked,cm)?void(cf.get_Body().checked=cm):null;}return cl;});cn=function(){return cb.Trigger($.New(m,{$:0,$0:cf.get_Body().checked}));};cf.get_Body().addEventListener("change",cn,true);return cf;},Css:function(cp,cq,cr,cs){var ct;ct=function(cu){var cv,cA;cv=function(cw){var cx,cy,cz;if(cw.$==0){cy=cw.$0;cz=cr(cy);cx=cu["HtmlProvider@33"].SetCss(cu.get_Body(),cq,cz);}else{cx=null;}return cx;};cv(cp.get_Latest());cA=cp.Subscribe(cv);return;};u.OnAfterRender(ct,cs);return cs;},CssResult:function(cB,cC,cD,cE){u.OnAfterRender(function(cF){var cG;cG=function(cH){var cI;cI=cD(cH);return cF["HtmlProvider@33"].SetCss(cF.get_Body(),cC,cI);};cG(cB.get_Latest());cB.Subscribe(cG);return;},cE);return cE;},EnableOnSuccess:function(cJ,cK){var cL;cL=function(cM){var cN;cM.get_Body().disabled=!cJ.get_Latest().get_isSuccess();cN=cJ.Subscribe(function(cO){cM.get_Body().disabled=!cO.get_isSuccess();});return;};u.OnAfterRender(cL,cK);return cK;},HtmlContainer:$.Class({Add:function(cP){return this.container.AppendI(cP);},MoveUp:function(cQ){var cR,cS,cT,cU;cR=this.container.get_Body().childNodes[cQ];cS=this.container.get_Body().childNodes[cQ-1];cT=this.container.get_Body().removeChild(cR);cU=this.container.get_Body().insertBefore(cR,cS);return;},Remove:function(cV){var cW;cW=this.container.get_Body().removeChild(this.container.get_Body().childNodes[cV]);return;},get_Container:function(){return this.container;}},{New:function(cX){var cY;cY=$.New(this,{});cY.container=cX;return cY;}}),IntInput:function(cZ){return x.input("number",function(c0){return c0<<0;},function(c1){return $$.String(c1);},cZ);},Link:function(c2){var c3,c4,c5;c3=g.ofArray([y.Attr().NewAttr("href","#")]);c4=v.Tags().NewTag("a",c3);c5=function(c6){return A(c6.get_Body()).on("click",function(c7){c2.Trigger($.New(m,{$:0,$0:null}));return c7.preventDefault();});};u.OnAfterRender(c5,c4);return c4;},Radio:function(c8,c9){var c_,c$,da,dh,di,dp;c_=(x.nextId())(null);c$=g.ofSeq(c9);da=function(db){var dc,dd,de;dc=v.Tags();dd=dc.NewTag("input",g.ofArray([y.Attr().NewAttr("type","radio"),y.Attr().NewAttr("name",c_)]));de=function(df){return function(){return df.get_Body().checked?c8.Trigger($.New(m,{$:0,$0:db})):null;};};w.Events().OnChange(de,dd);return dd;};dh=g.map(da,c$);di=function(dj){var dk,dl,dm;if(dj.$==1){dk=null;}else{dl=dj.$0;dm=function(dn){return function(_do){_do.get_Body().checked=z.Equals(dn,dl);};};dk=g.iter2(dm,c$,dh);}return dk;};di(c8.get_Latest());dp=c8.Subscribe(di);return dh;},RadioLabelled:function(dq,dr){var ds,du,dC;ds=x.Radio(dq,k.map(function(dt){return dt[0];},dr));du=function(dv){var dw,dx;dw=dv[0];dx=dv[1];return function(dy){var dz,dA,dB;dz=(x.nextId())(null);dB=g.ofArray([y.Attr().NewAttr("for",dz),v.Tags().text(dx)]);dA=g.ofArray([u.add(dy,g.ofArray([y.Attr().NewAttr("id",dz)])),v.Tags().NewTag("label",dB)]);return v.Tags().NewTag("span",dA);};};dC=k.map2(du,dr,ds);return v.Tags().NewTag("div",dC);},RenderChoice:function(dD,dE,dF){var dG;dG=B.New(dF);return dD.Choice(dG,dE);},RenderMany:function(dH,dI,dJ){var dK;dK=B.New(dJ);return dH.Render(dK,dI);},Select:function(dL,dM){var dN,dO,dP,dT,dU,dV,dW,dZ,d0;dN=(x.nextId())(null);dO=C.ofSeq(dM);dP=function(dQ){var dR,dS;dQ[0];dR=dQ[1];dS=(x.nextId())(null);return u.add(v.Tags().NewTag("option",g.ofArray([y.Attr().NewAttr("value",dS)])),g.ofArray([v.Tags().text(dR)]));};dT=C.map(dP,dO);dU=v.Tags();dV=dU.NewTag("select",dT);dW=function(dX){return function(){return dX.get_Body().selectedIndex>=0?dL.Trigger($.New(m,{$:0,$0:(C.get(dO,dX.get_Body().selectedIndex))[0]})):null;};};w.Events().OnChange(dW,dV);dZ=dV;d0=function(){var d2;d2=dL.Subscribe(function(d3){var d4,d5,d6,d9,d_,d$;if(d3.$==1){d4=null;}else{d5=d3.$0;d6=C.tryFindIndex(function(d7){var d8;d8=d7[0];d7[1];return z.Equals(d5,d8);},dO);if(d6.$==0){d9=null;}else{d_=d6.$0;d$=C.get(dT,d_);d9=d$["HtmlProvider@33"].SetAttribute(d$.get_Body(),"selected","");}d4=d9;}return d4;});return;};u.OnAfterRender(d0,dZ);return dZ;},Show:function(ea,eb,ec){var ed;ed=function(ee){var ef,eg;if(ee.$==1){ef=k.empty();}else{eg=ee.$0;ef=eb(eg);}return ef;};return x.ShowResult(ea,ed,ec);},ShowErrors:function(eh,ei,ej){var ek;ek=function(el){var em,en,eo;if(el.$==1){en=el.$0;eo=function(ep){return ep.get_Message();};em=ei(g.map(eo,en));}else{el.$0;em=k.empty();}return em;};return x.ShowResult(eh,ek,ej);},ShowResult:function(eq,er,es){var et,eu,ev,ew,ex;et=er(eq.get_Latest());eu=i.Get(et);try{while(eu.MoveNext()){ew=eu.get_Current();es.AppendI(ew);}}finally{eu.Dispose!=undefined?eu.Dispose():null;}ex=eq.Subscribe(function(ey){var ez,eA,eB,eC;es["HtmlProvider@33"].Clear(es.get_Body());ez=er(ey);eA=i.Get(ez);try{while(eA.MoveNext()){eC=eA.get_Current();es.AppendI(eC);}}finally{eA.Dispose!=undefined?eA.Dispose():null;}return eB;});return es;},ShowString:function(eD,eE,eF){return x.Show(eD,function(eG){var eH;eH=eE(eG);return g.ofArray([v.Tags().text(eH)]);},eF);},Submit:function(eI){var eJ,eK;eJ=v.Tags().NewTag("input",g.ofArray([y.Attr().NewAttr("type","submit")]));eK=function(){return function(){return eI.Trigger($.New(m,{$:0,$0:null}));};};w.Events().OnClick(eK,eJ);return eJ;},SubmitValidate:function(eN){var eO,eP;eO=x.Submit(eN);eP=eN.get_Input();return x.EnableOnSuccess(eP,eO);},TextArea:function(eQ){var eR,eS,eT,eU,eV,eW,eX,e1;eR=v.Tags();eS=$.New(h,{$:0});eT=eR.NewTag("textarea",eS);eU=eQ.get_Latest();if(eU.$==0){eW=eU.$0;eV=eT.set_Value(eW);}else{eV=null;}eX=eQ.Subscribe(function(eY){var eZ,e0;if(eY.$==1){eZ=null;}else{e0=eY.$0;eZ=eT.get_Value()!==e0?eT.set_Value(e0):null;}return eZ;});e1=function(){return eQ.Trigger($.New(m,{$:0,$0:eT.get_Value()}));};eT.get_Body().addEventListener("keyup",e1,true);eT.get_Body().addEventListener("change",e1,true);return eT;},WithLabel:function(e3,e4){var e5,e6,e7;e5=(x.nextId())(null);e7=g.ofArray([y.Attr().NewAttr("for",e5),v.Tags().text(e3)]);e6=g.ofArray([v.Tags().NewTag("label",e7),u.add(e4,g.ofArray([y.Attr().NewAttr("id",e5)]))]);return v.Tags().NewTag("span",e6);},WithLabelAfter:function(e8,e9){var e_,e$,fa;e_=(x.nextId())(null);fa=g.ofArray([y.Attr().NewAttr("for",e_),v.Tags().text(e8)]);e$=g.ofArray([u.add(e9,g.ofArray([y.Attr().NewAttr("id",e_)])),v.Tags().NewTag("label",fa)]);return v.Tags().NewTag("span",e$);},input:function(fb,fc,fd,fe){var ff,fg,fh,fi,fj,fk,fl,fq;ff=v.Tags();fg=g.ofArray([y.Attr().NewAttr("type",fb)]);fh=ff.NewTag("input",fg);fi=fe.get_Latest();if(fi.$==0){fk=fi.$0;fj=fh.set_Value(fd(fk));}else{fj=null;}fl=fe.Subscribe(function(fm){var fn,fo,fp;if(fm.$==1){fn=null;}else{fo=fm.$0;fp=fd(fo);fn=fh.get_Value()!==fp?fh.set_Value(fp):null;}return fn;});fq=function(){var fs;fs=$.New(m,{$:0,$0:fc(fh.get_Value())});return!z.Equals(fs,fe.get_Latest())?fe.Trigger(fs):null;};fh.get_Body().addEventListener("keyup",fq,true);fh.get_Body().addEventListener("change",fq,true);return fh;},nextId:$.Field(function(){var ft;ft=[0];return function(){D.incr(ft);return"pl__"+$$.String(ft[0]);};})},Disposable:$.Class({Dispose:function(){return this.dispose.call(null,null);}},{New:function(fv){var fw;fw=$.New(this,{});fw.dispose=fv;return fw;}}),ErrorMessage:$.Class({get_Message:function(){return this.message;},get_Source:function(){return this.source;}},{Create:function(fx,fy){return E.New(fx,fy.get_Id());},New:function(fz,fA){var fB;fB=$.New(this,{});fB.message=fz;fB.source=fA;return fB;}}),Id:{next:$.Field(function(){var fC;fC=[0];return function(){D.incr(fC);return fC[0];};})},Many:{Operations:$.Class({get_Delete:function(){return p.New1(this["delete"]);},get_MoveDown:function(){return this.moveDown;},get_MoveUp:function(){return this.moveUp;}},{New:function(fE,fF,fG){var fH;fH=$.New(this,{});fH["delete"]=fE;fH.moveUp=fF;fH.moveDown=fG;return fH;}}),Stream:$.Class({AddRender:function(fI){return this.adder.view.call(null,fI);},Render:function(fJ,fK){var fL,fO=this,gh,gi,gj,gk;fL=function(fM){var fN,fP,fR,fW,f0,f2,f4,f6,f8,f9,f_,ga,gb,gc,gd,ge;fN=fO.p.call(null,fM);fO.streams.Add(fN.stream);fP=fN.stream.Subscribe(function(){return fO.update();});fR=function(){var fT,fV;fT=function(fU){return fU.get_Id()===fN.stream.get_Id();};fV=fO.streams;return k.findIndex(fT,fV);};fW=function(fX){var fY,fZ;if(fX>0?fX<fO.streams.get_Count():false){fZ=fO.streams.get_Item(fX);fO.streams.set_Item(fX,fO.streams.get_Item(fX-1));fO.streams.set_Item(fX-1,fZ);fJ.MoveUp(fX);fY=fO.update();}else{fY=null;}return fY;};f0=function(){return fW(fR(null)+1);};f2=function(){return fW(fR(null));};f4=function(){return fR(null)>0?$.New(m,{$:0,$0:null}):$.New(m,{$:1,$0:$.New(h,{$:0})});};f6=function(){return fR(null)<fO.streams.get_Count()-1?$.New(m,{$:0,$0:null}):$.New(m,{$:1,$0:$.New(h,{$:0})});};f8=l.New(f4(null),{$:0});f9=l.New(f6(null),{$:0});f_=fO.out.Subscribe(function(){f8.Trigger(f4(null));return f9.Trigger(f6(null));});ga=H.New(f8,false);gb=H.New(f9,false);gc=ga.Subscribe(m.Iter(f2));gd=gb.Subscribe(m.Iter(f0));ge=function(){var gg;gg=fR(null);fO.streams.RemoveAt(gg);fJ.Remove(gg);f_.Dispose();gc.Dispose();gd.Dispose();return fO.update();};return fJ.Add(fN.view.call(null,fK(I.New(ge,ga,gb))));};gh=fO.out.get_Latest();if(gh.$==0){gj=gh.$0;gi=C.iter(fL,gj);}else{gi=null;}gk=fO.adder.stream.Subscribe(function(gl){var gm,gn;if(gl.$==0){gn=gl.$0;gm=fL(gn);}else{gm=null;}return gm;});return fJ.get_Container();},Subscribe:function(go){return this.out.Subscribe(go);},get_Add:function(){return this.adder.stream;},get_Latest:function(){return this.out.get_Latest();},update:function(){var gp,gs,gt,gG;gp=function(gq){var gr;gr=g.rev(gq);return C.ofSeq(gr);};gs=this.out;gt=k.fold(function(gu){return function(gv){var gw,gx,gy,gz,gA,gB,gC,gD,gE,gF;gw=[gu,gv.get_Latest()];if(gw[0].$==1){if(gw[1].$==1){gz=gw[0].$0;gA=gw[1].$0;gy=$.New(m,{$:1,$0:g.append(gA,gz)});}else{gB=gw[0].$0;gy=$.New(m,{$:1,$0:gB});}gx=gy;}else{if(gw[1].$==1){gD=gw[1].$0;gC=$.New(m,{$:1,$0:gD});}else{gE=gw[0].$0;gF=gw[1].$0;gC=$.New(m,{$:0,$0:$.New(h,{$:1,$0:gF,$1:gE})});}gx=gC;}return gx;};},$.New(m,{$:0,$0:$.New(h,{$:0})}),this.streams);gG=m.Map(gp,gt);return gs.Trigger(gG);}},{New:function(gH,gI,gJ){var gK;gK=$.New(this,d.New(gI.get_Id()));gK.p=gH;gK.out=gI;gK.adder=gJ;gK.streams=K.New2();return gK;}}),UnitStream:$.Class({get_Add:function(){return this.submitStream;}},{New:function(gL,gM,gN,gO){var gP,gQ,gR,gS,gU;gP=$.New(this,G.New(gL,gM,gN));gQ=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});gR=gN.get_Stream();gS=function(gT){return gR.Trigger(gT);};gU=gQ.Subscribe(function(gV){var gW,gX;if(gV.$==0){gW=gS($.New(m,{$:0,$0:gO}));}else{gX=gV.$0;gW=gS($.New(m,{$:1,$0:gX}));}return gW;});gP.submitStream=gQ;return gP;}})},Pervasives:{"Writer`1.Wrap.Static":function(gY,gZ){return p.New(function(g0){return gZ.Trigger(m.Map(gY,g0));});},"Writer`1.WrapAsync.Static":function(g1,g2){var g3;g3=function(g4){return M.Delay(function(){return M.Bind(g1(g4),function(g6){return M.Return($.New(m,{$:0,$0:g6}));});});};return N["Writer`1.WrapToAsyncResult.Static"](g3,g2);},"Writer`1.WrapAsyncResult.Static":function(g7,g8){return p.New(function(g9){var g_;g_=M.Delay(function(){return M.Bind(g7(g9),function(ha){g8.Trigger(ha);return M.Return(null);});});return M.Start(g_,{$:0});});},"Writer`1.WrapResult.Static":function(hb,hc){return p.New(function(hd){return hc.Trigger(hb(hd));});},"Writer`1.WrapToAsyncResult.Static":function(he,hf){var hg;hg=function(hh){return M.Delay(function(){var hj,hk,hl;if(hh.$==1){hk=hh.$0;hj=M.Return($.New(m,{$:1,$0:hk}));}else{hl=hh.$0;hj=he(hl);}return hj;});};return N["Writer`1.WrapAsyncResult.Static"](hg,hf);},"Writer`1.WrapToResult.Static":function(hm,hn){return p.New(function(ho){return hn.Trigger((m.Bind(hm))(ho));});},op_LessMultiplyGreater:function(hp,hq){var hr,hs;hr=hp.view;hs=hq.view;return $.New(O,{stream:P.Ap(hp.stream,hq.stream),view:function(ht){return hs(hr(ht));}});},op_LessMultiplyQmarkGreater:function(hu,hv){var hw,hx;hw=hu.view;hx=hv.view;return $.New(O,{stream:P.ApJoin(hu.stream,hv.stream),view:function(hy){return hx(hw(hy));}});}},Piglet:{Builder:$.Class({Bind:function(hz,hA){return Q.Choose(hz,hA);},Return:function(hB){return Q.Return(hB);},ReturnFrom:function(hC){return hC;},Yield:function(hD){return Q.Yield(hD);},YieldFrom:function(hE){return hE;},Zero:function(){return Q.ReturnFailure();}}),Choose:function(hF,hG){var hH,hI;hH=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});hI=c.New(hF,hG,hH);return $.New(O,{stream:hH,view:function(hJ){return hJ(hI);}});},Confirm:function(hK,hL,hM){var hN,hO,hR,hV,hW,hX,hY,h0,h1;hN=Q.Yield(hK);hO=N.op_LessMultiplyGreater(N.op_LessMultiplyGreater(Q.Return(function(hP){return function(hQ){return[hP,hQ];};}),hL(Q.Yield(hK))),hN);hR=function(hS){var hT,hU;hT=hS[0];hU=hS[1];return z.Equals(hT,hU);};hV=hN.get_Stream();hW=E.Create(hM,hV);hX=R["Is'"](hR,hW,hO);hY=function(hZ){return hZ[0];};h0=Q.Map(hY,hX);h1=function(h2){return function(h3){return[h2,h3];};};return Q.MapViewArgs(h1,h0);},FlushErrors:function(h4){return Q.MapResult(function(h5){return h5.$==1?$.New(m,{$:1,$0:$.New(h,{$:0})}):h5;},h4);},Many:function(h6,h7){return Q.ManyInit([h6],h6,h7);},ManyInit:function(h8,h9,h_){var h$,ia,ib;h$=l.New($.New(m,{$:0,$0:h8}),{$:0});ia=h_(h9);ib=L.New(h_,h$,ia,h9);return $.New(O,{stream:h$,view:function(ic){return ic(ib);}});},ManyPiglet:function(id,ie,_if){var ig,ih;ig=l.New($.New(m,{$:0,$0:id}),{$:0});ih=G.New(_if,ig,ie);return $.New(O,{stream:ig,view:function(ii){return ii(ih);}});},Map:function(ij,ik){var il;il=function(im){var _in,io,ip;if(im.$==0){io=im.$0;_in=$.New(m,{$:0,$0:ij(io)});}else{ip=im.$0;_in=$.New(m,{$:1,$0:ip});}return _in;};return Q.MapResult(il,ik);},MapAsync:function(iq,ir){var is;is=function(it){var iu,iv,iy;if(it.$==0){iv=it.$0;iu=M.Delay(function(){return M.Bind(iq(iv),function(ix){return M.Return($.New(m,{$:0,$0:ix}));});});}else{iy=it.$0;iu=M.Return($.New(m,{$:1,$0:iy}));}return iu;};return Q.MapAsyncResult(is,ir);},MapAsyncResult:function(iz,iA){var iB,iC,iH;iB=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});iC=iA.stream.Subscribe(function(iD){var iE;iE=M.Delay(function(){return M.Bind(iz(iD),function(iG){return M.Return(iB.Trigger(iG));});});return M.Start(iE,{$:0});});iH=M.Delay(function(){return M.Bind(iz(iA.stream.get_Latest()),function(iJ){return M.Return(iB.Trigger(iJ));});});M.Start(iH,{$:0});return $.New(O,{stream:iB,view:iA.view});},MapResult:function(iK,iL){var iM,iN;iM=l.New(iK(iL.stream.get_Latest()),{$:0});iN=iL.stream.Subscribe(function(iO){var iP;iP=iK(iO);return iM.Trigger(iP);});return $.New(O,{stream:iM,view:iL.view});},MapResultWithWriter:function(iQ,iR){var iS,iT;iS=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});iT=iR.stream.Subscribe(iQ(iS));return $.New(O,{stream:iS,view:iR.view});},MapToAsyncResult:function(iU,iV){var iW;iW=function(iX){var iY,iZ,i0;if(iX.$==0){iZ=iX.$0;iY=iU(iZ);}else{i0=iX.$0;iY=M.Return($.New(m,{$:1,$0:i0}));}return iY;};return Q.MapAsyncResult(iW,iV);},MapToResult:function(i1,i2){var i3;i3=function(i4){var i5,i6,i7;if(i4.$==0){i6=i4.$0;i5=i1(i6);}else{i7=i4.$0;i5=$.New(m,{$:1,$0:i7});}return i5;};return Q.MapResult(i3,i2);},MapViewArgs:function(i8,i9){var i_;i_=i9.view;return $.New(O,{stream:i9.stream,view:function(i$){return i$(i_(i8));}});},MapWithWriter:function(ja,jb){var jc;jc=function(jd){return function(je){var jf,jg,jh;if(je.$==0){jg=je.$0;jf=(ja(jd))(jg);}else{jh=je.$0;jf=jd.Trigger($.New(m,{$:1,$0:jh}));}return jf;};};return Q.MapResultWithWriter(jc,jb);},Render:function(ji,jj){return jj.view.call(null,ji);},Return:function(jk){return $.New(O,{stream:l.New($.New(m,{$:0,$0:jk}),{$:0}),view:function(jl){return jl;}});},ReturnFailure:function(){return $.New(O,{stream:l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0}),view:function(jm){return jm;}});},Run:function(jn,jo){return Q.RunResult(m.Iter(jn),jo);},RunResult:function(jp,jq){var jr;jr=jq.stream.Subscribe(jp);return jq;},TransmitReader:function(js){var jt,ju;jt=js.view;ju=js.stream;return $.New(O,{stream:js.stream,view:function(jv){return(jt(jv))(ju);}});},TransmitReaderMap:function(jw,jx){var jy,jz,jA;jy=jx.view;jz=jx.stream;jA=d.Map(jw,jz);return $.New(O,{stream:jx.stream,view:function(jB){return(jy(jB))(jA);}});},TransmitReaderMapResult:function(jC,jD){var jE,jF,jG;jE=jD.view;jF=jD.stream;jG=d.MapResult(jC,jF);return $.New(O,{stream:jD.stream,view:function(jH){return(jE(jH))(jG);}});},TransmitReaderMapToResult:function(jI,jJ){var jK,jL,jM;jK=jJ.view;jL=jJ.stream;jM=d.MapToResult(jI,jL);return $.New(O,{stream:jJ.stream,view:function(jN){return(jK(jN))(jM);}});},TransmitStream:function(jO){var jP,jQ;jP=jO.view;jQ=jO.stream;return $.New(O,{stream:jO.stream,view:function(jR){return(jP(jR))(jQ);}});},TransmitWriter:function(jS){var jT,jU;jT=jS.view;jU=jS.stream;return $.New(O,{stream:jS.stream,view:function(jV){return(jT(jV))(jU);}});},WithSubmit:function(jW){var jX,jY;jX=H.New(jW.stream,false);jY=jW.view;return $.New(O,{stream:jX.get_Output(),view:function(jZ){return(jY(jZ))(jX);}});},WithSubmitClearError:function(j0){var j1,j2;j1=H.New(j0.stream,true);j2=j0.view;return $.New(O,{stream:j1.get_Output(),view:function(j3){return(j2(j3))(j1);}});},Yield:function(j4){var j5;j5=l.New($.New(m,{$:0,$0:j4}),{$:0});return $.New(O,{stream:j5,view:function(j6){return j6(j5);}});},YieldFailure:function(){var j7;j7=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});return $.New(O,{stream:j7,view:function(j8){return j8(j7);}});},YieldOption:function(j9,j_){var j$,ka,ke,kg;j$=Q.Yield(j9);ka=function(kb){var kc,kd;if(kb.$==1){kd=kb.$0;kc=kd;}else{kc=j_;}return kc;};ke=function(kf){return z.Equals(kf,j_)?{$:0}:{$:1,$0:kf};};kg=function(kh){return P.Map(ka,ke,kh);};return Q.MapViewArgs(kg,j$);}},Piglet1:$.Class({get_Stream:function(){return this.stream;}}),Reader:$.Class({SubscribeImmediate:function(ki){return this.Subscribe(ki);},Through:function(kj){var kk,kl,kq=this;kk=l.New(this.get_Latest(),{$:0});kl=kj.Subscribe(function(km){var kn,ko,kp,kr,kt,ku,kv,kw,kx;if(km.$==1){ko=km.$0;kr=function(ks){return ks.get_Source()===kq.get_Id();};kp=[kq.get_Latest(),g.filter(kr,ko)];if(kp[1].$==0){kt=kk.Trigger(kq.get_Latest());}else{if(kp[0].$==1){kv=kp[1];kw=kp[0].$0;ku=kk.Trigger($.New(m,{$:1,$0:g.append(kw,kv)}));}else{kp[0].$0;kx=kp[1];ku=kk.Trigger($.New(m,{$:1,$0:kx}));}kt=ku;}kn=kt;}else{kn=kk.Trigger(kq.get_Latest());}return kn;});return kk;},get_Id:function(){return this.id;}},{Const:function(ky){return q.New($.New(m,{$:0,$0:ky}));},ConstResult:function(kz){return q.New(kz);},Map:function(kA,kB){var kC;kC=function(kD){return m.Map(kA,kD);};return d.MapResult(kC,kB);},Map2:function(kE,kF,kG){var kH;kH=function(kI){return function(kJ){return m.Map2(kE,kI,kJ);};};return d.MapResult2(kH,kF,kG);},MapResult:function(kK,kL){var kM,kN;kM=l.New(kK(kL.get_Latest()),{$:0});kN=kL.Subscribe(function(kO){var kP;kP=kK(kO);return kM.Trigger(kP);});return kM;},MapResult2:function(kQ,kR,kS){var kT,kU,kW;kT=l.New((kQ(kR.get_Latest()))(kS.get_Latest()),{$:0});kU=kR.Subscribe(function(kV){return kT.Trigger((kQ(kV))(kS.get_Latest()));});kW=kS.Subscribe(function(kX){return kT.Trigger((kQ(kR.get_Latest()))(kX));});return kT;},MapToResult:function(kY,kZ){var k0;k0=m.Bind(kY);return d.MapResult(k0,kZ);},New:function(k1){var k2;k2=$.New(this,{});k2.id=k1;return k2;}}),Result:$.Class({get_isSuccess:function(){return this.$==1?false:true;}},{Ap:function(k3,k4){var k5,k6,k7,k8,k9,k_,k$,la,lb,lc;k5=[k3,k4];if(k5[0].$==1){if(k5[1].$==1){k8=k5[0].$0;k9=k5[1].$0;k7=$.New(m,{$:1,$0:g.append(k8,k9)});}else{k_=k5[0].$0;k7=$.New(m,{$:1,$0:k_});}k6=k7;}else{if(k5[1].$==1){la=k5[1].$0;k$=$.New(m,{$:1,$0:la});}else{lb=k5[0].$0;lc=k5[1].$0;k$=$.New(m,{$:0,$0:lb(lc)});}k6=k$;}return k6;},Bind:function(ld){return function(le){var lf,lg,lh;if(le.$==1){lg=le.$0;lf=$.New(m,{$:1,$0:lg});}else{lh=le.$0;lf=ld(lh);}return lf;};},Failwith:function(li){return $.New(m,{$:1,$0:g.ofArray([E.New(li,0)])});},Iter:function(lj){return function(lk){var ll,lm;if(lk.$==1){ll=null;}else{lm=lk.$0;ll=lj(lm);}return ll;};},Join:function(ln){var lo,lp,lq,lr,ls;if(ln.$==0){if(ln.$0.$==0){lq=ln.$0.$0;lp=$.New(m,{$:0,$0:lq});}else{lr=ln.$0.$0;lp=$.New(m,{$:1,$0:lr});}lo=lp;}else{ls=ln.$0;lo=$.New(m,{$:1,$0:ls});}return lo;},Map:function(lt,lu){var lv,lw,lx;if(lu.$==1){lw=lu.$0;lv=$.New(m,{$:1,$0:lw});}else{lx=lu.$0;lv=$.New(m,{$:0,$0:lt(lx)});}return lv;},Map2:function(ly,lz,lA){var lB,lC,lD,lE,lF,lG,lH,lI,lJ,lK;lB=[lz,lA];if(lB[0].$==1){if(lB[1].$==1){lE=lB[0].$0;lF=lB[1].$0;lD=$.New(m,{$:1,$0:g.append(lE,lF)});}else{lG=lB[0].$0;lD=$.New(m,{$:1,$0:lG});}lC=lD;}else{if(lB[1].$==1){lI=lB[1].$0;lH=$.New(m,{$:1,$0:lI});}else{lJ=lB[0].$0;lK=lB[1].$0;lH=$.New(m,{$:0,$0:(ly(lJ))(lK)});}lC=lH;}return lC;}}),Stream:{Ap:function(lL,lM){var lN,lO,lQ;lN=l.New(m.Ap(lL.get_Latest(),lM.get_Latest()),{$:0});lO=lL.Subscribe(function(lP){return lN.Trigger(m.Ap(lP,lM.get_Latest()));});lQ=lM.Subscribe(function(lR){return lN.Trigger(m.Ap(lL.get_Latest(),lR));});return lN;},ApJoin:function(lS,lT){var lU,lV,lX;lU=l.New(m.Ap(lS.get_Latest(),m.Join(lT.get_Latest())),{$:0});lV=lS.Subscribe(function(lW){return lU.Trigger(m.Ap(lW,m.Join(lT.get_Latest())));});lX=lT.Subscribe(function(lY){return lU.Trigger(m.Ap(lS.get_Latest(),m.Join(lY)));});return lU;},Map:function(lZ,l0,l1){var l2,l3,l4,l5,l6,l9;l3=l1.get_Latest();l2=l.New(m.Map(lZ,l3),{$:1,$0:l1.get_Id()});l4=[l1.get_Latest()];l5=[l2.get_Latest()];l6=l1.Subscribe(function(l7){var l8;if(l4[0]!==l7){l5[0]=m.Map(lZ,l7);l8=l2.Trigger(l5[0]);}else{l8=null;}return l8;});l9=l2.Subscribe(function(l_){var l$;if(l5[0]!==l_){l4[0]=m.Map(l0,l_);l$=l1.Trigger(l4[0]);}else{l$=null;}return l$;});return l2;}},Stream1:$.Class({Subscribe:function(ma){return S.subscribeTo(this.s,ma);},Trigger:function(mb){return this.s.Trigger(mb);},Trigger1:function(mc){return this.Trigger(mc);},Write:function(md){var mg=this;return p.New(function(me){var mf,mh;if(me.$==0){mf=mg.Trigger($.New(m,{$:0,$0:md}));}else{mh=me.$0;mf=mg.Trigger($.New(m,{$:1,$0:mh}));}return mf;});},get_Latest:function(){return this.s.Latest[0].$0;}},{New:function(mi,mj){return $.New(this,l.New1(V.New(mi),mj));},New1:function(mk,ml){var mm,mn,mo;if(ml.$==0){mn=(o.next())(null);}else{mo=ml.$0;mn=mo;}mm=$.New(this,d.New(mn));mm.s=mk;return mm;}}),Submitter:$.Class({Subscribe:function(mp){return this.output.Subscribe(mp);},Trigger:function(){return this.writer.Trigger($.New(m,{$:0,$0:null}));},Trigger1:function(mq){return this.writer.Trigger(mq);},get_Input:function(){return this.input;},get_Latest:function(){return this.output.get_Latest();},get_Output:function(){return this.output;}},{New:function(mr,ms){var mt,mE,mF;mt=$.New(this,d.New((o.next())(null)));mt.input=mr;mt.output=l.New($.New(m,{$:1,$0:$.New(h,{$:0})}),{$:0});mt.writer=p.New(function(mu){var mv,mw,mx,my,mz,mA,mB,mC,mD;mv=[mu,mt.input.get_Latest()];if(mv[0].$==0){if(mv[1].$==0){my=mv[1].$0;mx=mt.output.Trigger($.New(m,{$:0,$0:my}));}else{mz=mv[1].$0;mx=mt.output.Trigger($.New(m,{$:1,$0:mz}));}mw=mx;}else{if(mv[1].$==0){mB=mv[0].$0;mA=mt.output.Trigger($.New(m,{$:1,$0:mB}));}else{mC=mv[0].$0;mD=mv[1].$0;mA=mt.output.Trigger($.New(m,{$:1,$0:g.append(mC,mD)}));}mw=mA;}return mw;});if(ms){mF=mt.input.Subscribe(function(){var mH;mH=mt.output.get_Latest();return mH.$==1?mH.$0.$==0?null:mt.output.Trigger($.New(m,{$:1,$0:$.New(h,{$:0})})):mt.output.Trigger($.New(m,{$:1,$0:$.New(h,{$:0})}));});mE=void mF;}else{mE=null;}return mt;}}),Validation:{Is:function(mI,mJ,mK){var mL,mM;mL=l.New(mK.stream.get_Latest(),{$:1,$0:mK.stream.get_Id()});mM=mK.stream.Subscribe(function(mN){var mO,mP,mQ,mR,mS;if(mN.$==0){mP=mN.$0;if(mI(mP)){mR=mN.$0;mQ=mL.Trigger($.New(m,{$:0,$0:mR}));}else{mQ=mL.Trigger($.New(m,{$:1,$0:g.ofArray([E.New(mJ,mL.get_Id())])}));}mO=mQ;}else{mS=mN.$0;mO=mL.Trigger($.New(m,{$:1,$0:mS}));}return mO;});return $.New(O,{stream:mL,view:mK.view});},"Is'":function(mT,mU,mV){var mW,mX;mW=l.New(mV.stream.get_Latest(),{$:1,$0:mV.stream.get_Id()});mX=mV.stream.Subscribe(function(mY){var mZ,m0,m1,m2,m3;if(mY.$==0){m0=mY.$0;if(mT(m0)){m2=mY.$0;m1=mW.Trigger($.New(m,{$:0,$0:m2}));}else{m1=mW.Trigger($.New(m,{$:1,$0:g.ofArray([mU])}));}mZ=m1;}else{m3=mY.$0;mZ=mW.Trigger($.New(m,{$:1,$0:m3}));}return mZ;});return $.New(O,{stream:mW,view:mV.view});},IsMatch:function(m4,m5,m6){return R.Is(R.Match(m4),m5,m6);},IsNotEmpty:function(m7,m8){return R.Is(function(m9){return R.NotEmpty(m9);},m7,m8);},Match:function(m_){var m$;m$=new W(m_);return function(na){return m$.test(na);};},NotEmpty:function(nb){return nb!=="";}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.Piglets);b=$.Safe(a.Choose);c=$.Safe(b.Stream);d=$.Safe(a.Reader);e=$.Safe($$.WebSharper.Collections);f=$.Safe(e.Dictionary);g=$.Safe($$.WebSharper.List);h=$.Safe(g.T);i=$.Safe($$.WebSharper.Enumerator);j=$.Safe($$.WebSharper.Operators);k=$.Safe($$.WebSharper.Seq);l=$.Safe(a.Stream1);m=$.Safe(a.Result);n=$.Safe(a.ConcreteReader);o=$.Safe(a.Id);p=$.Safe(a.ConcreteWriter);q=$.Safe(a.ConstReader);r=$.Safe(a.Disposable);s=$.Safe($$.WebSharper.Html);t=$.Safe(s.Client);u=$.Safe(t.Operators);v=$.Safe(t.Tags);w=$.Safe(t.EventsPervasives);x=$.Safe(a.Controls);y=$.Safe(t.Attr);z=$.Safe($$.WebSharper.Unchecked);A=$.Safe($$.jQuery);B=$.Safe(x.HtmlContainer);C=$.Safe($$.WebSharper.Arrays);D=$.Safe($$.WebSharper.Ref);E=$.Safe(a.ErrorMessage);F=$.Safe(a.Many);G=$.Safe(F.Stream);H=$.Safe(a.Submitter);I=$.Safe(F.Operations);J=$.Safe(e.ResizeArray);K=$.Safe(J.ResizeArrayProxy);L=$.Safe(F.UnitStream);M=$.Safe($$.WebSharper.Concurrency);N=$.Safe(a.Pervasives);O=$.Safe(a.Piglet1);P=$.Safe(a.Stream);Q=$.Safe(a.Piglet);R=$.Safe(a.Validation);S=$.Safe($$.WebSharper.Util);T=$.Safe($$.IntelliFactory);U=$.Safe(T.Reactive);V=$.Safe(U.HotStream);return W=$.Safe($$.RegExp);});$.OnLoad(function(){$.Inherit(c,d);$.Inherit(n,d);$.Inherit(q,d);$.Inherit(G,d);$.Inherit(G,d);$.Inherit(L,G);$.Inherit(l,d);$.Inherit(H,d);o.next();x.nextId();return;});}());
